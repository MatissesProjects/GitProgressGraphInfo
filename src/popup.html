<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    body {
      width: 250px;
      padding: 15px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      margin: 0;
      background-color: #ffffff;
      color: #24292f;
    }
    h1 {
      font-size: 18px;
      margin: 0 0 15px 0;
      border-bottom: 1px solid #d0d7de;
      padding-bottom: 8px;
    }
    .stat-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 14px;
    }
    .level-list {
      margin-top: 15px;
      padding-top: 10px;
      border-top: 1px solid #d0d7de;
    }
    .level-item {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
    }
    .square {
      width: 12px;
      height: 12px;
      border-radius: 2px;
      border: 1px solid rgba(27, 31, 35, 0.06);
    }
    .l1 { background-color: #9be9a8; }
    .l2 { background-color: #40c463; }
    .l3 { background-color: #30a14e; }
    .l4 { background-color: #216e39; }
    
    .rarity-list {
      margin-top: 15px;
      padding-top: 10px;
      border-top: 1px dotted #d0d7de;
    }
    .rarity-row {
      display: flex;
      align-items: center;
      margin-bottom: 4px;
      font-size: 11px;
    }
    .rarity-bar {
      height: 4px;
      background: #f6f8fa;
      flex-grow: 1;
      margin: 0 8px;
      border-radius: 2px;
      overflow: hidden;
      border: 1px solid #d0d7de;
    }
    .rarity-fill {
      height: 100%;
      background: #30a14e;
    }
    .rarity-label { width: 50px; text-align: right; }
    .rarity-value { width: 40px; font-weight: bold; }
    
    .error {
      color: #cf222e;
      font-size: 12px;
      display: none;
    }
    #content { display: none; }
    #loading { font-style: italic; color: #57606a; }
  </style>
</head>
<body>
  <h1>GitHeat Stats</h1>
  
  <div id="loading">Detecting GitHub profile...</div>
  <div id="error" class="error">Not on a GitHub profile or graph not loaded.</div>

  <div id="content">
    <div class="stat-row" style="margin-bottom: 5px;">
      <span style="font-size: 11px; color: #57606a;">PERSONA</span>
      <span id="persona-badge" class="Label Label--info" style="font-size: 11px;">-</span>
    </div>

    <div class="stat-row">
      <label for="theme-select" style="font-size: 12px; font-weight: 600;">THEME</label>
      <select id="theme-select" style="font-size: 12px; border-radius: 4px; border: 1px solid #d0d7de; padding: 2px 4px;">
        <option value="green">Classic Green</option>
        <option value="flame">Flame Heat</option>
        <option value="custom">Custom Range</option>
      </select>
    </div>

    <div class="visibility-toggles" style="margin-top: 10px; padding: 8px; background: #f6f8fa; border-radius: 6px; border: 1px solid #d0d7de;">
      <div style="font-size: 11px; font-weight: 600; margin-bottom: 5px;">PANEL SECTIONS</div>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px; margin-bottom: 10px;">
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 11px;">
          <input type="checkbox" id="toggle-grid" checked> Main Grid
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 11px;">
          <input type="checkbox" id="toggle-persona" checked> Persona
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 11px;">
          <input type="checkbox" id="toggle-active-repos" checked> Active Repos
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 11px;">
          <input type="checkbox" id="toggle-created-repos" checked> Created Repos
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 11px;">
          <input type="checkbox" id="toggle-achievements" checked> Achievements
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 11px;">
          <input type="checkbox" id="toggle-footer" checked> Footer Scale
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 11px;">
          <input type="checkbox" id="toggle-legend-numbers" checked> Legend Nums
        </label>
      </div>

      <div style="font-size: 11px; font-weight: 600; margin-bottom: 5px; border-top: 1px solid #d0d7de; pt-1;">MAIN GRID ITEMS</div>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-total" checked> Total Contribs
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-today" checked> Today's Contribs
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-streak" checked> Streak
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-best-month" checked> Best Month
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-best-week" checked> Best Week
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-island" checked> Biggest Island (L2+)
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-slump-island" checked> Worst Island (0-1)
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-velocity" checked> Velocity
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-consistency" checked> Consistency
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-weekend" checked> Weekend Score
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-slump" checked> Longest Slump
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-best-day" checked> Best Day
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-worst-day" checked> Worst Day
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-current-weekday" checked> Current Weekday
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-power-day" checked> Most Productive
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-peak-day" checked> Peak Frequency
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-most-active-day" checked> Most Active Day
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-max-commits" checked> Max Daily Commits
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-stars" checked> Pinned Stats
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-pr" checked> PR Activity
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-issue-created" checked> Issues/Created
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-langs" checked> Top Languages
        </label>
        <label class="toggle-item" style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
          <input type="checkbox" id="toggle-network" checked> Network Stats
        </label>
      </div>

      <div style="font-size: 11px; font-weight: 600; margin-bottom: 5px; border-top: 1px solid #d0d7de; pt-1;">REORDER GRID (Drag items)</div>
      <div id="sortable-grid-list" style="display: flex; flex-direction: column; gap: 2px;">
        <!-- Sortable items will be injected here -->
      </div>
    </div>

    <div id="custom-colors" style="display: none; margin-top: 10px; padding: 8px; background: #f6f8fa; border-radius: 6px; border: 1px solid #d0d7de;">
      <div class="stat-row" style="margin-bottom: 8px;">
        <label style="font-size: 11px; font-weight: 600;">START</label>
        <input type="color" id="color-start" value="#ebedf0" style="width: 40px; height: 20px; border: none; padding: 0; cursor: pointer;">
      </div>
      <div class="stat-row" style="margin-bottom: 0;">
        <label style="font-size: 11px; font-weight: 600;">STOP</label>
        <input type="color" id="color-stop" value="#216e39" style="width: 40px; height: 20px; border: none; padding: 0; cursor: pointer;">
      </div>
    </div>

    <div class="stat-row" style="margin-top: 10px;">
      <span>Total Contributions:</span>
      <strong id="total-count">-</strong>
    </div>

    <div class="stat-row">
      <span>Today's Contributions:</span>
      <strong id="today-count">-</strong>
    </div>

    <div class="level-list">
      <div class="level-item">
        <div class="square l1"></div>
        <span>Level 1:</span>
        <strong id="l1-range">-</strong>
      </div>
      <div class="level-item">
        <div class="square l2"></div>
        <span>Level 2:</span>
        <strong id="l2-range">-</strong>
      </div>
      <div class="level-item">
        <div class="square l3"></div>
        <span>Level 3:</span>
        <strong id="l3-range">-</strong>
      </div>
      <div class="level-item">
        <div class="square l4"></div>
        <span>Level 4:</span>
        <strong id="l4-range">-</strong>
      </div>
    </div>

    <div class="rarity-list" id="rarity-section">
      <div style="font-size: 12px; color: #57606a; margin-bottom: 8px; font-weight: 600;">ACTIVITY RARITY</div>
      <!-- Percentiles will be injected here -->
    </div>

    <div class="advanced-stats" style="margin-top: 15px; padding-top: 10px; border-top: 1px dotted #d0d7de;">
      <div style="font-size: 12px; color: #57606a; margin-bottom: 8px; font-weight: 600;">ADVANCED ANALYTICS</div>
      <div class="stat-row">
        <span>Current Streak:</span>
        <strong id="current-streak">-</strong>
      </div>
      <div class="stat-row">
        <span>Longest Streak:</span>
        <strong id="longest-streak">-</strong>
      </div>
      <div class="stat-row">
        <span>Longest Slump:</span>
        <strong id="longest-slump">-</strong>
      </div>
      <div class="stat-row">
        <span>Best Month:</span>
        <strong id="best-month">-</strong>
      </div>
      <div class="stat-row">
        <span>Best Week:</span>
        <strong id="best-week">-</strong>
      </div>
      <div class="stat-row">
        <span>Consistency:</span>
        <strong id="consistency">-</strong>
      </div>
      <div class="stat-row">
        <span>Avg Velocity:</span>
        <strong id="velocity">-</strong>
      </div>
      <div class="stat-row">
        <span>PRs (O/M/R):</span>
        <strong id="pr-stats">-</strong>
      </div>
      <div class="stat-row">
        <span>Issues/Created:</span>
        <strong id="issue-repo-stats">-</strong>
      </div>
      <div class="stat-row">
        <span>Weekend Score:</span>
        <strong id="weekend-score">-</strong>
      </div>
      <div class="stat-row">
        <span>Best Weekday:</span>
        <strong id="best-day">-</strong>
      </div>
      <div class="stat-row">
        <span>Worst Weekday:</span>
        <strong id="worst-day">-</strong>
      </div>
      <div class="stat-row">
        <span>Current Weekday:</span>
        <strong id="current-weekday">-</strong>
      </div>
      <div class="stat-row">
        <span>Most Productive:</span>
        <strong id="power-day">-</strong>
      </div>
      <div class="stat-row">
        <span>Peak Frequency:</span>
        <strong id="peak-day">-</strong>
      </div>
      <div class="stat-row">
        <span>Biggest Island (L2+):</span>
        <strong id="biggest-island">-</strong>
      </div>
      <div class="stat-row">
        <span>Worst Island (0-1):</span>
        <strong id="slump-island">-</strong>
      </div>
      <div class="stat-row">
        <span>Most Active Day:</span>
        <strong id="most-active-day">-</strong>
      </div>
      <div class="stat-row">
        <span>Max Daily Commits:</span>
        <strong id="max-commits">-</strong>
      </div>
      <div class="stat-row">
        <span>Pinned Stars/Forks:</span>
        <strong id="pinned-stats">-</strong>
      </div>
      <div class="stat-row">
        <span>Top Languages:</span>
        <strong id="top-langs">-</strong>
      </div>
      <div class="stat-row">
        <span>Network:</span>
        <strong id="socials">-</strong>
      </div>
    </div>

    <div id="repo-section" style="margin-top: 15px; padding-top: 10px; border-top: 1px dotted #d0d7de;">
      <div style="font-size: 12px; color: #57606a; margin-bottom: 8px; font-weight: 600;">MOST ACTIVE REPOS (Commits)</div>
      <div id="repo-list"></div>
    </div>

    <div id="created-repo-section" style="margin-top: 15px; padding-top: 10px; border-top: 1px dotted #d0d7de;">
      <div style="font-size: 12px; color: #57606a; margin-bottom: 8px; font-weight: 600;">CREATED REPOS</div>
      <div id="created-repo-list"></div>
    </div>

    <div id="achievement-section" style="margin-top: 15px; padding-top: 10px; border-top: 1px dotted #d0d7de;">
      <div style="font-size: 12px; color: #57606a; margin-bottom: 8px; font-weight: 600;">ACHIEVEMENTS</div>
      <div id="achievement-list" style="display: flex; flex-wrap: wrap; gap: 4px;"></div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
